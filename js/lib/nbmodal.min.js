try{if(!Nabu){throw"Nabu Manager not loaded"}}catch(e){throw"Nabu Manager not loaded"}if(typeof Nabu.UI==="undefined"){Nabu.UI=function(){}}Nabu.UI.Modal=function(a,b){this.container=a;this.params=b;this.modal=null;this.events=new Nabu.EventPool()};Nabu.UI.Modal.prototype={addEventListener:function(a){this.events.addEventListener(a)},removeEventListener:function(a){this.events.removeEventListener(a)},openRemote:function(a){var c=this;var b=new Nabu.Ajax.Connector(a,"GET",(this.params&&this.params.ajax?this.params.ajax:null));b.addEventListener(new Nabu.Event({onLoad:function(g){if(c.container!==null){c.container.innerHTML=g.params.text;nabu.callJavaScript(c.container);nbBootstrapToggleAll(c.container);var f=$(c.container).find('.modal[role="dialog"]');c.modal=f.length===1?f[0]:null;if(c.modal!==null){$(c.modal).on("show.bs.modal",function(h){c.events.fireEvent("onShowStart",c,{button:h.relatedTarget})});$(c.modal).on("shown.bs.modal",function(h){c.events.fireEvent("onShowCompleted",c,{button:h.relatedTarget})});$(c.modal).on("hide.bs.modal",function(){c.events.fireEvent("onHideStart",c)});$(c.modal).on("hidden.bs.modal",function(){$(c.container).empty();c.events.fireEvent("onHideCompleted",c)});var d=$(c.modal).find('[data-toggle="nabu-form"]');if(d.length===1){d.on("beforesubmit.form.nabu",function(){c.events.fireEvent("onBeforeSubmit")});d.on("response.form.nabu",function(h,i){c.events.fireEvent("onAfterSubmit",c,i)})}c.events.fireEvent("onLoad",c);$(c.modal).modal("show")}}},onError:function(d){c.events.fireEvent("onError",c,d)}}));b.execute()},close:function(){if(this.modal){$(this.modal).modal("hide")}}};nabu.registerLibrary("Modal",["Event","Ajax"]);