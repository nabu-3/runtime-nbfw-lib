try{if(!Nabu)throw"Nabu Manager not loaded"}catch(n){throw"Nabu Manager not loaded"}void 0===Nabu.UI&&(Nabu.UI=function(){}),Nabu.UI.Modal=function(n,e){this.container=n,this.params=e,this.modal=null,this.events=new Nabu.EventPool},Nabu.UI.Modal.prototype={addEventListener:function(n){this.events.addEventListener(n)},removeEventListener:function(n){this.events.removeEventListener(n)},openRemote:function(n){var e=this,t=new Nabu.Ajax.Connector(n,"GET",this.params&&this.params.ajax?this.params.ajax:null);t.addEventListener(new Nabu.Event({onLoad:function(n){if(null!==e.container){e.container.innerHTML=n.params.text,nabu.callJavaScript(e.container),nbBootstrapToggleAll(e.container);var t=$(e.container).find('.modal[role="dialog"]');if(e.modal=1===t.length?t[0]:null,null!==e.modal){$(e.modal).on("show.bs.modal",function(n){e.events.fireEvent("onShowStart",e,{button:n.relatedTarget})}),$(e.modal).on("shown.bs.modal",function(n){e.events.fireEvent("onShowCompleted",e,{button:n.relatedTarget})}),$(e.modal).on("hide.bs.modal",function(){e.events.fireEvent("onHideStart",e)}),$(e.modal).on("hidden.bs.modal",function(){$(e.container).empty(),e.events.fireEvent("onHideCompleted",e)});var o=$(e.modal).find('[data-toggle="nabu-form"]');1===o.length&&(o.on("beforesubmit.form.nabu",function(){e.events.fireEvent("onBeforeSubmit")}),o.on("response.form.nabu",function(n,t){e.events.fireEvent("onAfterSubmit",e,t)})),e.events.fireEvent("onLoad",e),$(e.modal).modal("show")}}},onError:function(n){e.events.fireEvent("onError",e,n)}})),t.execute()},close:function(){this.modal&&$(this.modal).modal("hide")}},nabu.registerLibrary("Modal",["Event","Ajax"]);