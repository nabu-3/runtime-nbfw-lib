try{if(!Nabu)throw"Nabu Manager not loaded"}catch(t){throw"Nabu Manager not loaded"}void 0===Nabu.UI&&(Nabu.UI=function(){}),Nabu.UI.Select=function(t,i){this.container=t,this.input=$(t).find('input[type="hidden"]'),this.caption=$(t).find("button:first-child").get(0),this.params=i,this.init()},Nabu.UI.Select.prototype={init:function(){var t=this;if(1===this.input.length&&$(this.container).find(".dropdown-menu [data-id]").off("click").on("click",function(i){t.selectItem($(this));var e=$(this).data("id");$(t.container).trigger("change.select.nabu",{option:e}),i.preventDefault()}),this.input.length>0){var i=this.input.val();if(i.length>0){var e=$(this.container).find('.dropdown-menu [data-id="'+i+'"]');e.length>0?(this.selectItem(e),$(this.container).trigger("init.select.nabu",{option:i})):this.clearSelection()}else this.clearSelection()}else this.clearSelection()},selectItem:function(t){var i=t.data("id");this.input.val(i);var e=$(this.container).data("captionMask"),n=t.get(0),a="a"==n.tagName.toLowerCase()?t.get(0).innerHTML:t.find("a").get(0).innerHTML;this.caption.innerHTML=void 0===e?a:$.sprintf(e,a),$(t).siblings(".active").removeClass("active"),$(t).addClass("active");var r=$(t).closest("form");r.length>0&&void 0!==r.get(0).nabuForm&&r.get(0).nabuForm.evaluateField(this.input.attr("name"))},clearSelection:function(){var t=this.input.length>0?this.input.length:null;this.input.removeAttr("value");var i=$(this.container).data("captionDefault");this.caption.innerText=void 0===i?"":i,$(this.container).find(".dropdown-menu .active").removeClass("active"),this.input.length>0&&$(this.container).trigger("clear.select.nabu",{prior_value:t})}},nabu.registerLibrary("Select",["Event","Ajax"]);